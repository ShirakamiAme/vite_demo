{"ast":null,"code":"import { ref, onMounted } from 'vue';\nimport { fetchCartByUserId } from '@/api/cart.js';\nexport default {\n  __name: 'ShoppingCart',\n  setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n    const cartItems = ref([]);\n    const loading = ref(false);\n    onMounted(async () => {\n      const userJson = localStorage.getItem('user');\n      if (!userJson) {\n        alert('请先登录');\n        window.location.href = '/login';\n        return;\n      }\n      try {\n        const user = JSON.parse(userJson);\n        if (user && user.user_id) {\n          loading.value = true;\n          const res = await fetchCartByUserId(user.user_id);\n          if (res.status === 200 && res.data.status === 'success') {\n            cartItems.value = res.data.data; // 期待后端返回数组\n          } else {\n            alert(res.data.message || '获取购物车失败');\n          }\n        } else {\n          alert('用户信息错误，请重新登录');\n          window.location.href = '/login';\n        }\n      } catch (e) {\n        console.error('解析用户数据失败', e);\n      } finally {\n        loading.value = false;\n      }\n    });\n    const __returned__ = {\n      cartItems,\n      loading,\n      ref,\n      onMounted,\n      get fetchCartByUserId() {\n        return fetchCartByUserId;\n      }\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["ref","onMounted","fetchCartByUserId","cartItems","loading","userJson","localStorage","getItem","alert","window","location","href","user","JSON","parse","user_id","value","res","status","data","message","e","console","error"],"sources":["D:/计算机/谭/shopping_website/src/views/ShoppingCart.vue"],"sourcesContent":["<template>\r\n  <div class=\"shopping-cart\">\r\n    <h2>购物车</h2>\r\n    <div v-if=\"loading\">加载中...</div>\r\n    <div v-else-if=\"cartItems.length === 0\">购物车空空如也</div>\r\n    <ul v-else class=\"cart-list\">\r\n      <li v-for=\"item in cartItems\" :key=\"item.cart_id\" class=\"cart-item\">\r\n        <img :src=\"item.product_image\" alt=\"商品图\" class=\"product-image\" />\r\n        <div class=\"product-info\">\r\n          <h3>{{ item.product_name }}</h3>\r\n          <p>单价: ¥{{ item.product_price.toFixed(2) }}</p>\r\n          <p>数量: {{ item.quantity }}</p>\r\n          <p>小计: ¥{{ (item.product_price * item.quantity).toFixed(2) }}</p>\r\n        </div>\r\n      </li>\r\n    </ul>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, onMounted } from 'vue';\r\nimport { fetchCartByUserId } from '@/api/cart.js';\r\n\r\nconst cartItems = ref([]);\r\nconst loading = ref(false);\r\n\r\nonMounted(async () => {\r\n  const userJson = localStorage.getItem('user');\r\n  if (!userJson) {\r\n    alert('请先登录');\r\n    window.location.href = '/login';\r\n    return;\r\n  }\r\n  try {\r\n    const user = JSON.parse(userJson);\r\n    if (user && user.user_id) {\r\n      loading.value = true;\r\n      const res = await fetchCartByUserId(user.user_id);\r\n      if (res.status === 200 && res.data.status === 'success') {\r\n        cartItems.value = res.data.data;  // 期待后端返回数组\r\n      } else {\r\n        alert(res.data.message || '获取购物车失败');\r\n      }\r\n    } else {\r\n      alert('用户信息错误，请重新登录');\r\n      window.location.href = '/login';\r\n    }\r\n  } catch (e) {\r\n    console.error('解析用户数据失败', e);\r\n  } finally {\r\n    loading.value = false;\r\n  }\r\n});\r\n</script>\r\n\r\n<style scoped>\r\n/* 你已有样式，这里简单示例 */\r\n.shopping-cart { padding: 20px; }\r\n.cart-list { list-style: none; padding: 0; }\r\n.cart-item { display: flex; margin-bottom: 10px; }\r\n.product-image { width: 80px; height: 80px; object-fit: cover; margin-right: 10px; }\r\n.product-info h3 { margin: 0 0 5px 0; }\r\n</style>\r\n"],"mappings":"AAoBA,SAASA,GAAG,EAAEC,SAAS,QAAQ,KAAK;AACpC,SAASC,iBAAiB,QAAQ,eAAe;;;;;;;IAEjD,MAAMC,SAAS,GAAGH,GAAG,CAAC,EAAE,CAAC;IACzB,MAAMI,OAAO,GAAGJ,GAAG,CAAC,KAAK,CAAC;IAE1BC,SAAS,CAAC,YAAY;MACpB,MAAMI,QAAQ,GAAGC,YAAY,CAACC,OAAO,CAAC,MAAM,CAAC;MAC7C,IAAI,CAACF,QAAQ,EAAE;QACbG,KAAK,CAAC,MAAM,CAAC;QACbC,MAAM,CAACC,QAAQ,CAACC,IAAI,GAAG,QAAQ;QAC/B;MACF;MACA,IAAI;QACF,MAAMC,IAAI,GAAGC,IAAI,CAACC,KAAK,CAACT,QAAQ,CAAC;QACjC,IAAIO,IAAI,IAAIA,IAAI,CAACG,OAAO,EAAE;UACxBX,OAAO,CAACY,KAAK,GAAG,IAAI;UACpB,MAAMC,GAAG,GAAG,MAAMf,iBAAiB,CAACU,IAAI,CAACG,OAAO,CAAC;UACjD,IAAIE,GAAG,CAACC,MAAM,KAAK,GAAG,IAAID,GAAG,CAACE,IAAI,CAACD,MAAM,KAAK,SAAS,EAAE;YACvDf,SAAS,CAACa,KAAK,GAAGC,GAAG,CAACE,IAAI,CAACA,IAAI,CAAC,CAAE;UACpC,CAAC,MAAM;YACLX,KAAK,CAACS,GAAG,CAACE,IAAI,CAACC,OAAO,IAAI,SAAS,CAAC;UACtC;QACF,CAAC,MAAM;UACLZ,KAAK,CAAC,cAAc,CAAC;UACrBC,MAAM,CAACC,QAAQ,CAACC,IAAI,GAAG,QAAQ;QACjC;MACF,CAAC,CAAC,OAAOU,CAAC,EAAE;QACVC,OAAO,CAACC,KAAK,CAAC,UAAU,EAAEF,CAAC,CAAC;MAC9B,CAAC,SAAS;QACRjB,OAAO,CAACY,KAAK,GAAG,KAAK;MACvB;IACF,CAAC,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}
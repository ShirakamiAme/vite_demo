{"ast":null,"code":"import { computed, onMounted, ref } from 'vue';\nimport { useStore } from 'vuex';\nimport axios from '@/api/axios';\nimport { fetchCartByUserId } from '@/api/cart';\nexport default {\n  __name: 'ShoppingCart',\n  setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n    const store = useStore();\n    const isLoggedIn = computed(() => store.state.isLoggedIn);\n    const username = computed(() => store.state.username);\n    const cartItems = ref([]);\n    const loading = ref(true);\n    const error = ref(null);\n    const fetchUserIdAndCart = async () => {\n      if (!isLoggedIn.value) {\n        error.value = 'ËØ∑ÂÖàÁôªÂΩï';\n        loading.value = false;\n        return;\n      }\n      try {\n        // 1. ÈÄöËøáÁî®Êà∑ÂêçÊü•ËØ¢Áî®Êà∑ ID\n        const userRes = await axios.get(`/users?username=${username.value}`);\n        const user = userRes.data.data?.[0];\n        if (!user || !user.user_id) {\n          throw new Error('Áî®Êà∑‰ø°ÊÅØÊó†Êïà');\n        }\n\n        // 2. Ê†πÊçÆÁî®Êà∑ ID ÊãâÂèñË¥≠Áâ©ËΩ¶\n        const cartRes = await fetchCartByUserId(user.user_id);\n        cartItems.value = cartRes.data.data;\n      } catch (err) {\n        console.error('‚ùå Âä†ËΩΩË¥≠Áâ©ËΩ¶Â§±Ë¥•:', err);\n        error.value = 'Âä†ËΩΩÂ§±Ë¥•ÔºåËØ∑Á®çÂêéÈáçËØï';\n      } finally {\n        loading.value = false;\n      }\n    };\n    onMounted(() => {\n      fetchUserIdAndCart();\n    });\n    const __returned__ = {\n      store,\n      isLoggedIn,\n      username,\n      cartItems,\n      loading,\n      error,\n      fetchUserIdAndCart,\n      computed,\n      onMounted,\n      ref,\n      get useStore() {\n        return useStore;\n      },\n      get axios() {\n        return axios;\n      },\n      get fetchCartByUserId() {\n        return fetchCartByUserId;\n      }\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["computed","onMounted","ref","useStore","axios","fetchCartByUserId","store","isLoggedIn","state","username","cartItems","loading","error","fetchUserIdAndCart","value","userRes","get","user","data","user_id","Error","cartRes","err","console"],"sources":["D:/ËÆ°ÁÆóÊú∫/Ë∞≠/shopping_website/src/views/ShoppingCart.vue"],"sourcesContent":["<script setup>\r\nimport { computed, onMounted, ref } from 'vue';\r\nimport { useStore } from 'vuex';\r\nimport axios from '@/api/axios';\r\nimport { fetchCartByUserId } from '@/api/cart';\r\n\r\nconst store = useStore();\r\n\r\nconst isLoggedIn = computed(() => store.state.isLoggedIn);\r\nconst username = computed(() => store.state.username);\r\n\r\nconst cartItems = ref([]);\r\nconst loading = ref(true);\r\nconst error = ref(null);\r\n\r\nconst fetchUserIdAndCart = async () => {\r\n  if (!isLoggedIn.value) {\r\n    error.value = 'ËØ∑ÂÖàÁôªÂΩï';\r\n    loading.value = false;\r\n    return;\r\n  }\r\n\r\n  try {\r\n    // 1. ÈÄöËøáÁî®Êà∑ÂêçÊü•ËØ¢Áî®Êà∑ ID\r\n    const userRes = await axios.get(`/users?username=${username.value}`);\r\n    const user = userRes.data.data?.[0];\r\n\r\n    if (!user || !user.user_id) {\r\n      throw new Error('Áî®Êà∑‰ø°ÊÅØÊó†Êïà');\r\n    }\r\n\r\n    // 2. Ê†πÊçÆÁî®Êà∑ ID ÊãâÂèñË¥≠Áâ©ËΩ¶\r\n    const cartRes = await fetchCartByUserId(user.user_id);\r\n    cartItems.value = cartRes.data.data;\r\n\r\n  } catch (err) {\r\n    console.error('‚ùå Âä†ËΩΩË¥≠Áâ©ËΩ¶Â§±Ë¥•:', err);\r\n    error.value = 'Âä†ËΩΩÂ§±Ë¥•ÔºåËØ∑Á®çÂêéÈáçËØï';\r\n  } finally {\r\n    loading.value = false;\r\n  }\r\n};\r\n\r\nonMounted(() => {\r\n  fetchUserIdAndCart();\r\n});\r\n</script>\r\n\r\n<template>\r\n  <div class=\"shopping-cart\">\r\n    <h2>üõí ÊàëÁöÑË¥≠Áâ©ËΩ¶</h2>\r\n\r\n    <p v-if=\"loading\">Âä†ËΩΩ‰∏≠...</p>\r\n    <p v-else-if=\"error\">{{ error }}</p>\r\n\r\n    <ul v-else-if=\"cartItems.length\">\r\n      <li v-for=\"item in cartItems\" :key=\"item.cart_id\">\r\n        <img :src=\"item.image\" alt=\"ÂïÜÂìÅÂõæ\" width=\"50\" />\r\n        <strong>{{ item.name }}</strong>\r\n        Êï∞ÈáèÔºö{{ item.quantity }}\r\n        Âçï‰ª∑Ôºö¬•{{ item.price_at_add.toFixed(2) }}\r\n      </li>\r\n    </ul>\r\n\r\n    <p v-else>Ë¥≠Áâ©ËΩ¶‰∏∫Á©∫</p>\r\n  </div>\r\n</template>\r\n\r\n<style scoped>\r\n.shopping-cart {\r\n  padding: 16px;\r\n}\r\nimg {\r\n  margin-right: 8px;\r\n}\r\n</style>\r\n"],"mappings":"AACA,SAASA,QAAQ,EAAEC,SAAS,EAAEC,GAAG,QAAQ,KAAK;AAC9C,SAASC,QAAQ,QAAQ,MAAM;AAC/B,OAAOC,KAAK,MAAM,aAAa;AAC/B,SAASC,iBAAiB,QAAQ,YAAY;;;;;;;IAE9C,MAAMC,KAAK,GAAGH,QAAQ,CAAC,CAAC;IAExB,MAAMI,UAAU,GAAGP,QAAQ,CAAC,MAAMM,KAAK,CAACE,KAAK,CAACD,UAAU,CAAC;IACzD,MAAME,QAAQ,GAAGT,QAAQ,CAAC,MAAMM,KAAK,CAACE,KAAK,CAACC,QAAQ,CAAC;IAErD,MAAMC,SAAS,GAAGR,GAAG,CAAC,EAAE,CAAC;IACzB,MAAMS,OAAO,GAAGT,GAAG,CAAC,IAAI,CAAC;IACzB,MAAMU,KAAK,GAAGV,GAAG,CAAC,IAAI,CAAC;IAEvB,MAAMW,kBAAkB,GAAG,MAAAA,CAAA,KAAY;MACrC,IAAI,CAACN,UAAU,CAACO,KAAK,EAAE;QACrBF,KAAK,CAACE,KAAK,GAAG,MAAM;QACpBH,OAAO,CAACG,KAAK,GAAG,KAAK;QACrB;MACF;MAEA,IAAI;QACF;QACA,MAAMC,OAAO,GAAG,MAAMX,KAAK,CAACY,GAAG,CAAC,mBAAmBP,QAAQ,CAACK,KAAK,EAAE,CAAC;QACpE,MAAMG,IAAI,GAAGF,OAAO,CAACG,IAAI,CAACA,IAAI,GAAG,CAAC,CAAC;QAEnC,IAAI,CAACD,IAAI,IAAI,CAACA,IAAI,CAACE,OAAO,EAAE;UAC1B,MAAM,IAAIC,KAAK,CAAC,QAAQ,CAAC;QAC3B;;QAEA;QACA,MAAMC,OAAO,GAAG,MAAMhB,iBAAiB,CAACY,IAAI,CAACE,OAAO,CAAC;QACrDT,SAAS,CAACI,KAAK,GAAGO,OAAO,CAACH,IAAI,CAACA,IAAI;MAErC,CAAC,CAAC,OAAOI,GAAG,EAAE;QACZC,OAAO,CAACX,KAAK,CAAC,YAAY,EAAEU,GAAG,CAAC;QAChCV,KAAK,CAACE,KAAK,GAAG,YAAY;MAC5B,CAAC,SAAS;QACRH,OAAO,CAACG,KAAK,GAAG,KAAK;MACvB;IACF,CAAC;IAEDb,SAAS,CAAC,MAAM;MACdY,kBAAkB,CAAC,CAAC;IACtB,CAAC,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}
{"ast":null,"code":"import \"core-js/modules/es.iterator.constructor.js\";\nimport \"core-js/modules/es.iterator.find.js\";\nimport \"core-js/modules/es.iterator.reduce.js\";\nimport { ref, onMounted, computed } from 'vue';\nimport axios from '@/api/axios';\nexport default {\n  __name: 'ShoppingCart',\n  setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n    const cartItems = ref([]);\n    const loading = ref(true);\n    const error = ref(null);\n    const username = ref('Ê∏∏ÂÆ¢');\n    const isLoggedIn = ref(false);\n    const userId = ref(null);\n    const totalPrice = computed(() => cartItems.value.reduce((sum, item) => sum + item.quantity * item.price_at_add, 0));\n    onMounted(async () => {\n      // 1. Âà§Êñ≠ÁôªÂΩïÁä∂ÊÄÅ\n      const userJson = localStorage.getItem('user');\n      if (!userJson) {\n        isLoggedIn.value = false;\n        loading.value = false;\n        return;\n      }\n      try {\n        const user = JSON.parse(userJson);\n        if (user && user.user_name) {\n          username.value = user.user_name;\n          isLoggedIn.value = true;\n\n          // 2. Ëé∑ÂèñÁî®Êà∑ID\n          const userRes = await axios.get('/users');\n          const foundUser = userRes.data.data.find(u => u.user_name === username.value);\n          if (!foundUser) {\n            error.value = 'Êú™ÊâæÂà∞ËØ•Áî®Êà∑';\n            loading.value = false;\n            return;\n          }\n          userId.value = foundUser.user_id;\n\n          // 3. Ëé∑ÂèñË¥≠Áâ©ËΩ¶Êï∞ÊçÆ\n          const cartRes = await axios.get(`/cart/${userId.value}`);\n          if (cartRes.data.status === 'success') {\n            cartItems.value = cartRes.data.data;\n          } else {\n            error.value = cartRes.data.message;\n          }\n        }\n      } catch (err) {\n        console.error(err);\n        error.value = 'Âä†ËΩΩË¥≠Áâ©ËΩ¶Â§±Ë¥•';\n      } finally {\n        loading.value = false;\n      }\n    });\n    const __returned__ = {\n      cartItems,\n      loading,\n      error,\n      username,\n      isLoggedIn,\n      userId,\n      totalPrice,\n      ref,\n      onMounted,\n      computed,\n      get axios() {\n        return axios;\n      }\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["ref","onMounted","computed","axios","cartItems","loading","error","username","isLoggedIn","userId","totalPrice","value","reduce","sum","item","quantity","price_at_add","userJson","localStorage","getItem","user","JSON","parse","user_name","userRes","get","foundUser","data","find","u","user_id","cartRes","status","message","err","console"],"sources":["D:/ËÆ°ÁÆóÊú∫/Ë∞≠/shopping_website/src/views/ShoppingCart.vue"],"sourcesContent":["<template>\r\n  <div class=\"shopping-cart\">\r\n    <h2>üõí ÊàëÁöÑË¥≠Áâ©ËΩ¶</h2>\r\n\r\n    <div v-if=\"!isLoggedIn\" class=\"not-logged-in\">\r\n      <p>ÊÇ®Â∞öÊú™ÁôªÂΩïÔºåËØ∑ÂÖà <a href=\"/login\">ÁôªÂΩï</a> Êü•ÁúãË¥≠Áâ©ËΩ¶„ÄÇ</p>\r\n    </div>\r\n\r\n    <div v-else>\r\n      <div v-if=\"loading\">Ê≠£Âú®Âä†ËΩΩË¥≠Áâ©ËΩ¶...</div>\r\n      <div v-else-if=\"error\">{{ error }}</div>\r\n      <div v-else-if=\"cartItems.length === 0\">Ë¥≠Áâ©ËΩ¶‰∏∫Á©∫</div>\r\n      <div v-else>\r\n        <div class=\"cart-item\" v-for=\"item in cartItems\" :key=\"item.cart_id\">\r\n          <img :src=\"item.image\" alt=\"ÂïÜÂìÅÂõæÁâá\" class=\"product-image\" />\r\n          <div class=\"item-details\">\r\n            <p class=\"product-name\">{{ item.name }}</p>\r\n            <p>Êï∞ÈáèÔºö{{ item.quantity }}</p>\r\n            <p>Âçï‰ª∑Ôºö¬•{{ item.price_at_add }}</p>\r\n            <p>Â∞èËÆ°Ôºö¬•{{ item.price_at_add * item.quantity }}</p>\r\n          </div>\r\n        </div>\r\n\r\n        <div class=\"cart-summary\">\r\n          <p><strong>ÊÄªËÆ°Ôºö</strong>¬•{{ totalPrice }}</p>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, onMounted, computed } from 'vue'\r\nimport axios from '@/api/axios'\r\n\r\nconst cartItems = ref([])\r\nconst loading = ref(true)\r\nconst error = ref(null)\r\n\r\nconst username = ref('Ê∏∏ÂÆ¢')\r\nconst isLoggedIn = ref(false)\r\nconst userId = ref(null)\r\n\r\nconst totalPrice = computed(() =>\r\n    cartItems.value.reduce((sum, item) => sum + item.quantity * item.price_at_add, 0)\r\n)\r\n\r\nonMounted(async () => {\r\n  // 1. Âà§Êñ≠ÁôªÂΩïÁä∂ÊÄÅ\r\n  const userJson = localStorage.getItem('user')\r\n  if (!userJson) {\r\n    isLoggedIn.value = false\r\n    loading.value = false\r\n    return\r\n  }\r\n\r\n  try {\r\n    const user = JSON.parse(userJson)\r\n    if (user && user.user_name) {\r\n      username.value = user.user_name\r\n      isLoggedIn.value = true\r\n\r\n      // 2. Ëé∑ÂèñÁî®Êà∑ID\r\n      const userRes = await axios.get('/users')\r\n      const foundUser = userRes.data.data.find(\r\n          (u) => u.user_name === username.value\r\n      )\r\n\r\n      if (!foundUser) {\r\n        error.value = 'Êú™ÊâæÂà∞ËØ•Áî®Êà∑'\r\n        loading.value = false\r\n        return\r\n      }\r\n\r\n      userId.value = foundUser.user_id\r\n\r\n      // 3. Ëé∑ÂèñË¥≠Áâ©ËΩ¶Êï∞ÊçÆ\r\n      const cartRes = await axios.get(`/cart/${userId.value}`)\r\n      if (cartRes.data.status === 'success') {\r\n        cartItems.value = cartRes.data.data\r\n      } else {\r\n        error.value = cartRes.data.message\r\n      }\r\n    }\r\n  } catch (err) {\r\n    console.error(err)\r\n    error.value = 'Âä†ËΩΩË¥≠Áâ©ËΩ¶Â§±Ë¥•'\r\n  } finally {\r\n    loading.value = false\r\n  }\r\n})\r\n</script>\r\n\r\n<style scoped>\r\n.shopping-cart {\r\n  max-width: 800px;\r\n  margin: 0 auto;\r\n  padding: 20px;\r\n}\r\n.not-logged-in {\r\n  color: #666;\r\n  text-align: center;\r\n}\r\n.cart-item {\r\n  display: flex;\r\n  gap: 16px;\r\n  margin-bottom: 20px;\r\n  border-bottom: 1px solid #eee;\r\n  padding-bottom: 10px;\r\n}\r\n.product-image {\r\n  width: 80px;\r\n  height: 80px;\r\n  object-fit: cover;\r\n}\r\n.item-details {\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 4px;\r\n}\r\n.cart-summary {\r\n  margin-top: 20px;\r\n  font-size: 1.2em;\r\n  text-align: right;\r\n}\r\n</style>\r\n"],"mappings":";;;AAgCA,SAASA,GAAG,EAAEC,SAAS,EAAEC,QAAQ,QAAQ,KAAK;AAC9C,OAAOC,KAAK,MAAM,aAAa;;;;;;;IAE/B,MAAMC,SAAS,GAAGJ,GAAG,CAAC,EAAE,CAAC;IACzB,MAAMK,OAAO,GAAGL,GAAG,CAAC,IAAI,CAAC;IACzB,MAAMM,KAAK,GAAGN,GAAG,CAAC,IAAI,CAAC;IAEvB,MAAMO,QAAQ,GAAGP,GAAG,CAAC,IAAI,CAAC;IAC1B,MAAMQ,UAAU,GAAGR,GAAG,CAAC,KAAK,CAAC;IAC7B,MAAMS,MAAM,GAAGT,GAAG,CAAC,IAAI,CAAC;IAExB,MAAMU,UAAU,GAAGR,QAAQ,CAAC,MACxBE,SAAS,CAACO,KAAK,CAACC,MAAM,CAAC,CAACC,GAAG,EAAEC,IAAI,KAAKD,GAAG,GAAGC,IAAI,CAACC,QAAQ,GAAGD,IAAI,CAACE,YAAY,EAAE,CAAC,CACpF,CAAC;IAEDf,SAAS,CAAC,YAAY;MACpB;MACA,MAAMgB,QAAQ,GAAGC,YAAY,CAACC,OAAO,CAAC,MAAM,CAAC;MAC7C,IAAI,CAACF,QAAQ,EAAE;QACbT,UAAU,CAACG,KAAK,GAAG,KAAK;QACxBN,OAAO,CAACM,KAAK,GAAG,KAAK;QACrB;MACF;MAEA,IAAI;QACF,MAAMS,IAAI,GAAGC,IAAI,CAACC,KAAK,CAACL,QAAQ,CAAC;QACjC,IAAIG,IAAI,IAAIA,IAAI,CAACG,SAAS,EAAE;UAC1BhB,QAAQ,CAACI,KAAK,GAAGS,IAAI,CAACG,SAAS;UAC/Bf,UAAU,CAACG,KAAK,GAAG,IAAI;;UAEvB;UACA,MAAMa,OAAO,GAAG,MAAMrB,KAAK,CAACsB,GAAG,CAAC,QAAQ,CAAC;UACzC,MAAMC,SAAS,GAAGF,OAAO,CAACG,IAAI,CAACA,IAAI,CAACC,IAAI,CACnCC,CAAC,IAAKA,CAAC,CAACN,SAAS,KAAKhB,QAAQ,CAACI,KACpC,CAAC;UAED,IAAI,CAACe,SAAS,EAAE;YACdpB,KAAK,CAACK,KAAK,GAAG,QAAQ;YACtBN,OAAO,CAACM,KAAK,GAAG,KAAK;YACrB;UACF;UAEAF,MAAM,CAACE,KAAK,GAAGe,SAAS,CAACI,OAAO;;UAEhC;UACA,MAAMC,OAAO,GAAG,MAAM5B,KAAK,CAACsB,GAAG,CAAC,SAAShB,MAAM,CAACE,KAAK,EAAE,CAAC;UACxD,IAAIoB,OAAO,CAACJ,IAAI,CAACK,MAAM,KAAK,SAAS,EAAE;YACrC5B,SAAS,CAACO,KAAK,GAAGoB,OAAO,CAACJ,IAAI,CAACA,IAAI;UACrC,CAAC,MAAM;YACLrB,KAAK,CAACK,KAAK,GAAGoB,OAAO,CAACJ,IAAI,CAACM,OAAO;UACpC;QACF;MACF,CAAC,CAAC,OAAOC,GAAG,EAAE;QACZC,OAAO,CAAC7B,KAAK,CAAC4B,GAAG,CAAC;QAClB5B,KAAK,CAACK,KAAK,GAAG,SAAS;MACzB,CAAC,SAAS;QACRN,OAAO,CAACM,KAAK,GAAG,KAAK;MACvB;IACF,CAAC,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}
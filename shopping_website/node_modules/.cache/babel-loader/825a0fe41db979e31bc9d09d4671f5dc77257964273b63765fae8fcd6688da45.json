{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport { ref, onMounted, onUnmounted } from 'vue';\nimport { useRouter } from 'vue-router';\nimport useUserStore from '@/composables/useUserStore';\nimport '../src/assets/css/SiteHeader.css';\nexport default {\n  __name: 'SiteHeader',\n  setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n    const router = useRouter();\n    const {\n      isLoggedIn,\n      username,\n      userEmail,\n      cartCount,\n      logout: storeLogout\n    } = useUserStore();\n    const showUserMenu = ref(false);\n    const searchQuery = ref('');\n    const userMenuRef = ref(null);\n    const userIconRef = ref(null);\n\n    // 搜索功能\n    function performSearch() {\n      if (searchQuery.value.trim()) {\n        router.push({\n          path: '/search',\n          query: {\n            q: searchQuery.value\n          }\n        });\n        searchQuery.value = ''; // 清空搜索框\n      }\n    }\n\n    // 语音搜索\n    function startVoiceSearch() {\n      const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;\n      if (SpeechRecognition) {\n        const recognition = new SpeechRecognition();\n        recognition.lang = 'zh-CN';\n        recognition.interimResults = false;\n        recognition.maxAlternatives = 1;\n        recognition.onresult = event => {\n          const transcript = event.results[0][0].transcript;\n          if (transcript) {\n            searchQuery.value = transcript;\n            performSearch();\n          }\n        };\n        recognition.onerror = event => {\n          console.error('语音识别错误:', event.error);\n          alert(`语音识别错误: ${event.error}`);\n        };\n        recognition.onend = () => {\n          console.log('语音识别结束');\n        };\n        recognition.start();\n      } else {\n        alert('您的浏览器不支持语音识别功能');\n      }\n    }\n\n    // 图像搜索\n    function openImageSearch() {\n      const input = document.createElement('input');\n      input.type = 'file';\n      input.accept = 'image/*';\n      input.capture = 'camera';\n      input.onchange = e => {\n        const file = e.target.files[0];\n        if (file) {\n          // 实际项目中应调用API进行图像搜索\n          alert(`已选择图像: ${file.name}`);\n          router.push({\n            path: '/image-search',\n            query: {\n              img: file.name\n            }\n          });\n        }\n      };\n      input.click();\n    }\n\n    // 登录/登出处理\n    function handleLoginClick() {\n      if (isLoggedIn.value) {\n        showUserMenu.value = !showUserMenu.value;\n      } else {\n        router.push('/login');\n      }\n    }\n\n    // 登出处理\n    function logout() {\n      storeLogout();\n      showUserMenu.value = false;\n      router.push('/');\n    }\n\n    // 跳转到购物车\n    function goToCart() {\n      router.push('/shoppingcart');\n    }\n\n    // 点击外部关闭菜单\n    const handleClickOutside = event => {\n      if (showUserMenu.value && userMenuRef.value && userIconRef.value && !userMenuRef.value.contains(event.target) && !userIconRef.value.contains(event.target)) {\n        showUserMenu.value = false;\n      }\n    };\n\n    // 添加全局点击监听\n    onMounted(() => {\n      document.addEventListener('click', handleClickOutside);\n    });\n\n    // 清理监听器\n    onUnmounted(() => {\n      document.removeEventListener('click', handleClickOutside);\n    });\n    const __returned__ = {\n      router,\n      isLoggedIn,\n      username,\n      userEmail,\n      cartCount,\n      storeLogout,\n      showUserMenu,\n      searchQuery,\n      userMenuRef,\n      userIconRef,\n      performSearch,\n      startVoiceSearch,\n      openImageSearch,\n      handleLoginClick,\n      logout,\n      goToCart,\n      handleClickOutside,\n      ref,\n      onMounted,\n      onUnmounted,\n      get useRouter() {\n        return useRouter;\n      },\n      get useUserStore() {\n        return useUserStore;\n      }\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["ref","onMounted","onUnmounted","useRouter","useUserStore","router","isLoggedIn","username","userEmail","cartCount","logout","storeLogout","showUserMenu","searchQuery","userMenuRef","userIconRef","performSearch","value","trim","push","path","query","q","startVoiceSearch","SpeechRecognition","window","webkitSpeechRecognition","recognition","lang","interimResults","maxAlternatives","onresult","event","transcript","results","onerror","console","error","alert","onend","log","start","openImageSearch","input","document","createElement","type","accept","capture","onchange","e","file","target","files","name","img","click","handleLoginClick","goToCart","handleClickOutside","contains","addEventListener","removeEventListener"],"sources":["D:/计算机/谭/shopping_website/src/components/layout/SiteHeader.vue"],"sourcesContent":["<!-- @/components/layout/SiteHeader.vue -->\r\n<template>\r\n  <header>\r\n    <div class=\"container header-content\">\r\n      <a href=\"/\" class=\"logo\">\r\n        <font-awesome-icon :icon=\"['fas', 'leaf']\" />\r\n        <span>绿意生活</span>\r\n      </a>\r\n\r\n      <form class=\"search\" @submit.prevent=\"performSearch\">\r\n        <button type=\"submit\" class=\"search__button\">\r\n          <div class=\"search__icon\">\r\n            <!-- 搜索图标SVG代码 -->\r\n          </div>\r\n        </button>\r\n        <input\r\n            type=\"text\"\r\n            class=\"search__input\"\r\n            id=\"search__input\"\r\n            placeholder=\"搜索商品...\"\r\n            v-model=\"searchQuery\"\r\n            @keyup.enter=\"performSearch\"\r\n            aria-label=\"搜索商品\"\r\n        >\r\n        <button class=\"mic__button\" type=\"button\" @click=\"startVoiceSearch\">\r\n          <div class=\"mic__icon\">\r\n            <!-- 麦克风图标SVG代码 -->\r\n          </div>\r\n        </button>\r\n        <button class=\"picture__button\" type=\"button\" @click=\"openImageSearch\">\r\n          <div class=\"picture__icon\">\r\n            <!-- 图片搜索图标SVG代码 -->\r\n          </div>\r\n        </button>\r\n      </form>\r\n\r\n      <div class=\"nav-icons\">\r\n        <a\r\n            ref=\"userIconRef\"\r\n            :href=\"isLoggedIn ? '#' : '/login'\"\r\n            class=\"nav-icon\"\r\n            :class=\"isLoggedIn ? 'logged_in' : 'not_logged_in'\"\r\n            @click.prevent=\"handleLoginClick\"\r\n        >\r\n          <font-awesome-icon :icon=\"['fas', 'user']\" />\r\n          <span v-if=\"isLoggedIn\" class=\"username\">{{ username }}</span>\r\n        </a>\r\n\r\n        <a href=\"#\" class=\"nav-icon\" @click.prevent=\"toggleWishlist\">\r\n          <font-awesome-icon :icon=\"['fas', 'heart']\" />\r\n        </a>\r\n\r\n        <a href=\"/shoppingcart\" class=\"nav-icon cart-icon\" @click.prevent=\"goToCart\">\r\n          <font-awesome-icon :icon=\"['fas', 'shopping-cart']\" />\r\n          <span class=\"cart-count\" v-if=\"cartCount > 0\">{{ cartCount }}</span>\r\n        </a>\r\n      </div>\r\n\r\n      <!-- 用户下拉菜单 -->\r\n      <div\r\n          v-if=\"isLoggedIn && showUserMenu\"\r\n          ref=\"userMenuRef\"\r\n          class=\"user-dropdown\"\r\n      >\r\n        <div class=\"user-info\">\r\n          <div class=\"user-name\">{{ username }}</div>\r\n          <div class=\"user-email\">{{ userEmail }}</div>\r\n        </div>\r\n        <ul class=\"user-menu\">\r\n          <li><a href=\"/profile\">个人资料</a></li>\r\n          <li><a href=\"/orders\">我的订单</a></li>\r\n          <li><a href=\"/settings\">设置</a></li>\r\n          <li><button @click=\"logout\">退出登录</button></li>\r\n        </ul>\r\n      </div>\r\n    </div>\r\n  </header>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, onMounted, onUnmounted } from 'vue';\r\nimport { useRouter } from 'vue-router';\r\nimport useUserStore from '@/composables/useUserStore';\r\n\r\nimport '../src/assets/css/SiteHeader.css'\r\n\r\nconst router = useRouter();\r\nconst {\r\n  isLoggedIn,\r\n  username,\r\n  userEmail,\r\n  cartCount,\r\n  logout: storeLogout\r\n} = useUserStore();\r\n\r\nconst showUserMenu = ref(false);\r\nconst searchQuery = ref('');\r\nconst userMenuRef = ref(null);\r\nconst userIconRef = ref(null);\r\n\r\n// 搜索功能\r\nfunction performSearch() {\r\n  if (searchQuery.value.trim()) {\r\n    router.push({ path: '/search', query: { q: searchQuery.value } });\r\n    searchQuery.value = ''; // 清空搜索框\r\n  }\r\n}\r\n\r\n// 语音搜索\r\nfunction startVoiceSearch() {\r\n  const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;\r\n\r\n  if (SpeechRecognition) {\r\n    const recognition = new SpeechRecognition();\r\n    recognition.lang = 'zh-CN';\r\n    recognition.interimResults = false;\r\n    recognition.maxAlternatives = 1;\r\n\r\n    recognition.onresult = (event) => {\r\n      const transcript = event.results[0][0].transcript;\r\n      if (transcript) {\r\n        searchQuery.value = transcript;\r\n        performSearch();\r\n      }\r\n    };\r\n\r\n    recognition.onerror = (event) => {\r\n      console.error('语音识别错误:', event.error);\r\n      alert(`语音识别错误: ${event.error}`);\r\n    };\r\n\r\n    recognition.onend = () => {\r\n      console.log('语音识别结束');\r\n    };\r\n\r\n    recognition.start();\r\n  } else {\r\n    alert('您的浏览器不支持语音识别功能');\r\n  }\r\n}\r\n\r\n// 图像搜索\r\nfunction openImageSearch() {\r\n  const input = document.createElement('input');\r\n  input.type = 'file';\r\n  input.accept = 'image/*';\r\n  input.capture = 'camera';\r\n\r\n  input.onchange = (e) => {\r\n    const file = e.target.files[0];\r\n    if (file) {\r\n      // 实际项目中应调用API进行图像搜索\r\n      alert(`已选择图像: ${file.name}`);\r\n      router.push({\r\n        path: '/image-search',\r\n        query: { img: file.name }\r\n      });\r\n    }\r\n  };\r\n\r\n  input.click();\r\n}\r\n\r\n// 登录/登出处理\r\nfunction handleLoginClick() {\r\n  if (isLoggedIn.value) {\r\n    showUserMenu.value = !showUserMenu.value;\r\n  } else {\r\n    router.push('/login');\r\n  }\r\n}\r\n\r\n// 登出处理\r\nfunction logout() {\r\n  storeLogout();\r\n  showUserMenu.value = false;\r\n  router.push('/');\r\n}\r\n\r\n// 跳转到购物车\r\nfunction goToCart() {\r\n  router.push('/shoppingcart');\r\n}\r\n\r\n// 点击外部关闭菜单\r\nconst handleClickOutside = (event) => {\r\n  if (\r\n      showUserMenu.value &&\r\n      userMenuRef.value &&\r\n      userIconRef.value &&\r\n      !userMenuRef.value.contains(event.target) &&\r\n      !userIconRef.value.contains(event.target)\r\n  ) {\r\n    showUserMenu.value = false;\r\n  }\r\n};\r\n\r\n// 添加全局点击监听\r\nonMounted(() => {\r\n  document.addEventListener('click', handleClickOutside);\r\n});\r\n\r\n// 清理监听器\r\nonUnmounted(() => {\r\n  document.removeEventListener('click', handleClickOutside);\r\n});\r\n</script>\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}
{"ast":null,"code":"import { createElementVNode as _createElementVNode, createTextVNode as _createTextVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, toDisplayString as _toDisplayString, renderList as _renderList, Fragment as _Fragment } from \"vue\";\nconst _hoisted_1 = {\n  class: \"shopping-cart\"\n};\nconst _hoisted_2 = {\n  key: 0,\n  class: \"not-logged-in\"\n};\nconst _hoisted_3 = {\n  key: 1\n};\nconst _hoisted_4 = {\n  key: 0\n};\nconst _hoisted_5 = {\n  key: 1\n};\nconst _hoisted_6 = {\n  key: 2\n};\nconst _hoisted_7 = {\n  key: 3\n};\nconst _hoisted_8 = [\"src\"];\nconst _hoisted_9 = {\n  class: \"item-details\"\n};\nconst _hoisted_10 = {\n  class: \"product-name\"\n};\nconst _hoisted_11 = {\n  class: \"cart-summary\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_cache[2] || (_cache[2] = _createElementVNode(\"h2\", null, \"üõí ÊàëÁöÑË¥≠Áâ©ËΩ¶\", -1 /* HOISTED */)), !$setup.isLoggedIn ? (_openBlock(), _createElementBlock(\"div\", _hoisted_2, _cache[0] || (_cache[0] = [_createElementVNode(\"p\", null, [_createTextVNode(\"ÊÇ®Â∞öÊú™ÁôªÂΩïÔºåËØ∑ÂÖà \"), _createElementVNode(\"a\", {\n    href: \"/login\"\n  }, \"ÁôªÂΩï\"), _createTextVNode(\" Êü•ÁúãË¥≠Áâ©ËΩ¶„ÄÇ\")], -1 /* HOISTED */)]))) : (_openBlock(), _createElementBlock(\"div\", _hoisted_3, [$setup.loading ? (_openBlock(), _createElementBlock(\"div\", _hoisted_4, \"Ê≠£Âú®Âä†ËΩΩË¥≠Áâ©ËΩ¶...\")) : $setup.error ? (_openBlock(), _createElementBlock(\"div\", _hoisted_5, _toDisplayString($setup.error), 1 /* TEXT */)) : $setup.cartItems.length === 0 ? (_openBlock(), _createElementBlock(\"div\", _hoisted_6, \"Ë¥≠Áâ©ËΩ¶‰∏∫Á©∫\")) : (_openBlock(), _createElementBlock(\"div\", _hoisted_7, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList($setup.cartItems, item => {\n    return _openBlock(), _createElementBlock(\"div\", {\n      class: \"cart-item\",\n      key: item.cart_id\n    }, [_createElementVNode(\"img\", {\n      src: item.image,\n      alt: \"ÂïÜÂìÅÂõæÁâá\",\n      class: \"product-image\"\n    }, null, 8 /* PROPS */, _hoisted_8), _createElementVNode(\"div\", _hoisted_9, [_createElementVNode(\"p\", _hoisted_10, _toDisplayString(item.name), 1 /* TEXT */), _createElementVNode(\"p\", null, \"Êï∞ÈáèÔºö\" + _toDisplayString(item.quantity), 1 /* TEXT */), _createElementVNode(\"p\", null, \"Âçï‰ª∑Ôºö¬•\" + _toDisplayString(item.price_at_add), 1 /* TEXT */), _createElementVNode(\"p\", null, \"Â∞èËÆ°Ôºö¬•\" + _toDisplayString(item.price_at_add * item.quantity), 1 /* TEXT */)])]);\n  }), 128 /* KEYED_FRAGMENT */)), _createElementVNode(\"div\", _hoisted_11, [_createElementVNode(\"p\", null, [_cache[1] || (_cache[1] = _createElementVNode(\"strong\", null, \"ÊÄªËÆ°Ôºö\", -1 /* HOISTED */)), _createTextVNode(\"¬•\" + _toDisplayString($setup.totalPrice), 1 /* TEXT */)])])]))]))]);\n}","map":{"version":3,"names":["class","_createElementBlock","_hoisted_1","_createElementVNode","$setup","isLoggedIn","_hoisted_2","_cache","href","_hoisted_3","loading","_hoisted_4","error","_hoisted_5","_toDisplayString","cartItems","length","_hoisted_6","_hoisted_7","_Fragment","_renderList","item","key","cart_id","src","image","alt","_hoisted_9","_hoisted_10","name","quantity","price_at_add","_hoisted_11","totalPrice"],"sources":["D:\\ËÆ°ÁÆóÊú∫\\Ë∞≠\\shopping_website\\src\\views\\ShoppingCart.vue"],"sourcesContent":["<template>\r\n  <div class=\"shopping-cart\">\r\n    <h2>üõí ÊàëÁöÑË¥≠Áâ©ËΩ¶</h2>\r\n\r\n    <div v-if=\"!isLoggedIn\" class=\"not-logged-in\">\r\n      <p>ÊÇ®Â∞öÊú™ÁôªÂΩïÔºåËØ∑ÂÖà <a href=\"/login\">ÁôªÂΩï</a> Êü•ÁúãË¥≠Áâ©ËΩ¶„ÄÇ</p>\r\n    </div>\r\n\r\n    <div v-else>\r\n      <div v-if=\"loading\">Ê≠£Âú®Âä†ËΩΩË¥≠Áâ©ËΩ¶...</div>\r\n      <div v-else-if=\"error\">{{ error }}</div>\r\n      <div v-else-if=\"cartItems.length === 0\">Ë¥≠Áâ©ËΩ¶‰∏∫Á©∫</div>\r\n      <div v-else>\r\n        <div class=\"cart-item\" v-for=\"item in cartItems\" :key=\"item.cart_id\">\r\n          <img :src=\"item.image\" alt=\"ÂïÜÂìÅÂõæÁâá\" class=\"product-image\" />\r\n          <div class=\"item-details\">\r\n            <p class=\"product-name\">{{ item.name }}</p>\r\n            <p>Êï∞ÈáèÔºö{{ item.quantity }}</p>\r\n            <p>Âçï‰ª∑Ôºö¬•{{ item.price_at_add }}</p>\r\n            <p>Â∞èËÆ°Ôºö¬•{{ item.price_at_add * item.quantity }}</p>\r\n          </div>\r\n        </div>\r\n\r\n        <div class=\"cart-summary\">\r\n          <p><strong>ÊÄªËÆ°Ôºö</strong>¬•{{ totalPrice }}</p>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, onMounted, computed } from 'vue'\r\nimport axios from '@/api/axios'\r\n\r\nconst cartItems = ref([])\r\nconst loading = ref(true)\r\nconst error = ref(null)\r\n\r\nconst username = ref('Ê∏∏ÂÆ¢')\r\nconst isLoggedIn = ref(false)\r\nconst userId = ref(null)\r\n\r\nconst totalPrice = computed(() =>\r\n    cartItems.value.reduce((sum, item) => sum + item.quantity * item.price_at_add, 0)\r\n)\r\n\r\nonMounted(async () => {\r\n  // 1. Âà§Êñ≠ÁôªÂΩïÁä∂ÊÄÅ\r\n  const userJson = localStorage.getItem('user')\r\n  if (!userJson) {\r\n    isLoggedIn.value = false\r\n    loading.value = false\r\n    return\r\n  }\r\n\r\n  try {\r\n    const user = JSON.parse(userJson)\r\n    if (user && user.user_name) {\r\n      username.value = user.user_name\r\n      isLoggedIn.value = true\r\n\r\n      // 2. Ëé∑ÂèñÁî®Êà∑ID\r\n      const userRes = await axios.get('/users')\r\n      const foundUser = userRes.data.data.find(\r\n          (u) => u.user_name === username.value\r\n      )\r\n\r\n      if (!foundUser) {\r\n        error.value = 'Êú™ÊâæÂà∞ËØ•Áî®Êà∑'\r\n        loading.value = false\r\n        return\r\n      }\r\n\r\n      userId.value = foundUser.user_id\r\n\r\n      // 3. Ëé∑ÂèñË¥≠Áâ©ËΩ¶Êï∞ÊçÆ\r\n      const cartRes = await axios.get(`/cart/${userId.value}`)\r\n      if (cartRes.data.status === 'success') {\r\n        cartItems.value = cartRes.data.data\r\n      } else {\r\n        error.value = cartRes.data.message\r\n      }\r\n    }\r\n  } catch (err) {\r\n    console.error(err)\r\n    error.value = 'Âä†ËΩΩË¥≠Áâ©ËΩ¶Â§±Ë¥•'\r\n  } finally {\r\n    loading.value = false\r\n  }\r\n})\r\n</script>\r\n\r\n<style scoped>\r\n.shopping-cart {\r\n  max-width: 800px;\r\n  margin: 0 auto;\r\n  padding: 20px;\r\n}\r\n.not-logged-in {\r\n  color: #666;\r\n  text-align: center;\r\n}\r\n.cart-item {\r\n  display: flex;\r\n  gap: 16px;\r\n  margin-bottom: 20px;\r\n  border-bottom: 1px solid #eee;\r\n  padding-bottom: 10px;\r\n}\r\n.product-image {\r\n  width: 80px;\r\n  height: 80px;\r\n  object-fit: cover;\r\n}\r\n.item-details {\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 4px;\r\n}\r\n.cart-summary {\r\n  margin-top: 20px;\r\n  font-size: 1.2em;\r\n  text-align: right;\r\n}\r\n</style>\r\n"],"mappings":";;EACOA,KAAK,EAAC;AAAe;;;EAGAA,KAAK,EAAC;;;;;;;;;;;;;;;;;;;EAWnBA,KAAK,EAAC;AAAc;;EACpBA,KAAK,EAAC;AAAc;;EAOtBA,KAAK,EAAC;AAAc;;uBAtB/BC,mBAAA,CA2BM,OA3BNC,UA2BM,G,0BA1BJC,mBAAA,CAAiB,YAAb,UAAQ,sB,CAEAC,MAAA,CAAAC,UAAU,I,cAAtBJ,mBAAA,CAEM,OAFNK,UAEM,EAAAC,MAAA,QAAAA,MAAA,OADJJ,mBAAA,CAA8C,Y,iBAA3C,WAAS,GAAAA,mBAAA,CAAuB;IAApBK,IAAI,EAAC;EAAQ,GAAC,IAAE,G,iBAAI,SAAO,E,yCAG5CP,mBAAA,CAmBM,OAAAQ,UAAA,GAlBOL,MAAA,CAAAM,OAAO,I,cAAlBT,mBAAA,CAAoC,OAAAU,UAAA,EAAhB,YAAU,KACdP,MAAA,CAAAQ,KAAK,I,cAArBX,mBAAA,CAAwC,OAAAY,UAAA,EAAAC,gBAAA,CAAdV,MAAA,CAAAQ,KAAK,oBACfR,MAAA,CAAAW,SAAS,CAACC,MAAM,U,cAAhCf,mBAAA,CAAmD,OAAAgB,UAAA,EAAX,OAAK,M,cAC7ChB,mBAAA,CAcM,OAAAiB,UAAA,I,kBAbJjB,mBAAA,CAQMkB,SAAA,QAAAC,WAAA,CARgChB,MAAA,CAAAW,SAAS,EAAjBM,IAAI;yBAAlCpB,mBAAA,CAQM;MARDD,KAAK,EAAC,WAAW;MAA4BsB,GAAG,EAAED,IAAI,CAACE;QAC1DpB,mBAAA,CAA0D;MAApDqB,GAAG,EAAEH,IAAI,CAACI,KAAK;MAAEC,GAAG,EAAC,MAAM;MAAC1B,KAAK,EAAC;yCACxCG,mBAAA,CAKM,OALNwB,UAKM,GAJJxB,mBAAA,CAA2C,KAA3CyB,WAA2C,EAAAd,gBAAA,CAAhBO,IAAI,CAACQ,IAAI,kBACpC1B,mBAAA,CAA6B,WAA1B,KAAG,GAAAW,gBAAA,CAAGO,IAAI,CAACS,QAAQ,kBACtB3B,mBAAA,CAAkC,WAA/B,MAAI,GAAAW,gBAAA,CAAGO,IAAI,CAACU,YAAY,kBAC3B5B,mBAAA,CAAkD,WAA/C,MAAI,GAAAW,gBAAA,CAAGO,IAAI,CAACU,YAAY,GAAGV,IAAI,CAACS,QAAQ,iB;kCAI/C3B,mBAAA,CAEM,OAFN6B,WAEM,GADJ7B,mBAAA,CAA4C,Y,0BAAzCA,mBAAA,CAAoB,gBAAZ,KAAG,sB,iBAAS,GAAC,GAAAW,gBAAA,CAAGV,MAAA,CAAA6B,UAAU,iB","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}
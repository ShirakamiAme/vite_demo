{"ast":null,"code":"import { onMounted, ref, computed } from 'vue';\nimport { fetchCartByUserId } from '@/api/cart';\nimport axios from '@/api/axios';\nexport default {\n  __name: 'ShoppingCart',\n  setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n    const cartItems = ref([]);\n    const loading = ref(true);\n    const error = ref(null);\n\n    // ‰ªé localStorage Ëé∑ÂèñÁî®Êà∑ÂêçÔºà‰πüÂèØËÉΩ‰ªé Pinia Êàñ Vuex Ëé∑ÂèñÔºâ\n    const username = localStorage.getItem('username'); // ÂÅáËÆæ‰Ω†Âú®ÁôªÂΩïÂêéÂ≠òÂÇ®‰∫ÜÁî®Êà∑Âêç\n\n    const isLoggedIn = computed(() => !!username);\n    const fetchUserIdAndCart = async () => {\n      if (!isLoggedIn.value) {\n        error.value = 'Áî®Êà∑Êú™ÁôªÂΩï';\n        loading.value = false;\n        return;\n      }\n      try {\n        // 1. ÈÄöËøáÁî®Êà∑ÂêçÊü•Áî®Êà∑ID\n        const userRes = await axios.get(`/users?username=${username}`);\n        const user = userRes.data.data?.[0]; // Êé•Âè£ËøîÂõûÁöÑÊòØÊï∞ÁªÑËøòÊòØÂØπË±°ÔºåÊ†πÊçÆÂÆûÈôÖË∞ÉÊï¥\n\n        if (!user || !user.user_id) {\n          throw new Error('Áî®Êà∑‰ø°ÊÅØËé∑ÂèñÂ§±Ë¥•');\n        }\n\n        // 2. ÊãâÂèñË¥≠Áâ©ËΩ¶\n        const cartRes = await fetchCartByUserId(user.user_id);\n        cartItems.value = cartRes.data.data;\n      } catch (err) {\n        console.error('‚ùå Âä†ËΩΩÂ§±Ë¥•:', err);\n        error.value = 'Âä†ËΩΩË¥≠Áâ©ËΩ¶Â§±Ë¥•ÔºåËØ∑Á®çÂêéÈáçËØï';\n      } finally {\n        loading.value = false;\n      }\n    };\n    onMounted(() => {\n      fetchUserIdAndCart();\n    });\n    const __returned__ = {\n      cartItems,\n      loading,\n      error,\n      username,\n      isLoggedIn,\n      fetchUserIdAndCart,\n      onMounted,\n      ref,\n      computed,\n      get fetchCartByUserId() {\n        return fetchCartByUserId;\n      },\n      get axios() {\n        return axios;\n      }\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["onMounted","ref","computed","fetchCartByUserId","axios","cartItems","loading","error","username","localStorage","getItem","isLoggedIn","fetchUserIdAndCart","value","userRes","get","user","data","user_id","Error","cartRes","err","console"],"sources":["D:/ËÆ°ÁÆóÊú∫/Ë∞≠/shopping_website/src/views/ShoppingCart.vue"],"sourcesContent":["<script setup>\r\nimport { onMounted, ref, computed } from 'vue';\r\nimport { fetchCartByUserId } from '@/api/cart';\r\nimport axios from '@/api/axios';\r\n\r\nconst cartItems = ref([]);\r\nconst loading = ref(true);\r\nconst error = ref(null);\r\n\r\n// ‰ªé localStorage Ëé∑ÂèñÁî®Êà∑ÂêçÔºà‰πüÂèØËÉΩ‰ªé Pinia Êàñ Vuex Ëé∑ÂèñÔºâ\r\nconst username = localStorage.getItem('username');  // ÂÅáËÆæ‰Ω†Âú®ÁôªÂΩïÂêéÂ≠òÂÇ®‰∫ÜÁî®Êà∑Âêç\r\n\r\nconst isLoggedIn = computed(() => !!username);\r\n\r\nconst fetchUserIdAndCart = async () => {\r\n  if (!isLoggedIn.value) {\r\n    error.value = 'Áî®Êà∑Êú™ÁôªÂΩï';\r\n    loading.value = false;\r\n    return;\r\n  }\r\n\r\n  try {\r\n    // 1. ÈÄöËøáÁî®Êà∑ÂêçÊü•Áî®Êà∑ID\r\n    const userRes = await axios.get(`/users?username=${username}`);\r\n    const user = userRes.data.data?.[0]; // Êé•Âè£ËøîÂõûÁöÑÊòØÊï∞ÁªÑËøòÊòØÂØπË±°ÔºåÊ†πÊçÆÂÆûÈôÖË∞ÉÊï¥\r\n\r\n    if (!user || !user.user_id) {\r\n      throw new Error('Áî®Êà∑‰ø°ÊÅØËé∑ÂèñÂ§±Ë¥•');\r\n    }\r\n\r\n    // 2. ÊãâÂèñË¥≠Áâ©ËΩ¶\r\n    const cartRes = await fetchCartByUserId(user.user_id);\r\n    cartItems.value = cartRes.data.data;\r\n\r\n  } catch (err) {\r\n    console.error('‚ùå Âä†ËΩΩÂ§±Ë¥•:', err);\r\n    error.value = 'Âä†ËΩΩË¥≠Áâ©ËΩ¶Â§±Ë¥•ÔºåËØ∑Á®çÂêéÈáçËØï';\r\n  } finally {\r\n    loading.value = false;\r\n  }\r\n};\r\n\r\nonMounted(() => {\r\n  fetchUserIdAndCart();\r\n});\r\n</script>\r\n\r\n<template>\r\n  <div class=\"shopping-cart\">\r\n    <h2>üõí ÊàëÁöÑË¥≠Áâ©ËΩ¶</h2>\r\n\r\n    <p v-if=\"loading\">Âä†ËΩΩ‰∏≠...</p>\r\n    <p v-else-if=\"error\">{{ error }}</p>\r\n\r\n    <ul v-else-if=\"cartItems.length\">\r\n      <li v-for=\"item in cartItems\" :key=\"item.cart_id\">\r\n        <img :src=\"item.image\" alt=\"ÂïÜÂìÅÂõæ\" width=\"50\"/>\r\n        <strong>{{ item.name }}</strong>\r\n        Êï∞ÈáèÔºö{{ item.quantity }}\r\n        Âçï‰ª∑Ôºö¬•{{ item.price_at_add.toFixed(2) }}\r\n      </li>\r\n    </ul>\r\n\r\n    <p v-else>Ë¥≠Áâ©ËΩ¶‰∏∫Á©∫</p>\r\n  </div>\r\n</template>\r\n\r\n<style scoped>\r\n.shopping-cart {\r\n  padding: 16px;\r\n}\r\n\r\nimg {\r\n  margin-right: 8px;\r\n}\r\n</style>\r\n"],"mappings":"AACA,SAASA,SAAS,EAAEC,GAAG,EAAEC,QAAQ,QAAQ,KAAK;AAC9C,SAASC,iBAAiB,QAAQ,YAAY;AAC9C,OAAOC,KAAK,MAAM,aAAa;;;;;;;IAE/B,MAAMC,SAAS,GAAGJ,GAAG,CAAC,EAAE,CAAC;IACzB,MAAMK,OAAO,GAAGL,GAAG,CAAC,IAAI,CAAC;IACzB,MAAMM,KAAK,GAAGN,GAAG,CAAC,IAAI,CAAC;;IAEvB;IACA,MAAMO,QAAQ,GAAGC,YAAY,CAACC,OAAO,CAAC,UAAU,CAAC,CAAC,CAAE;;IAEpD,MAAMC,UAAU,GAAGT,QAAQ,CAAC,MAAM,CAAC,CAACM,QAAQ,CAAC;IAE7C,MAAMI,kBAAkB,GAAG,MAAAA,CAAA,KAAY;MACrC,IAAI,CAACD,UAAU,CAACE,KAAK,EAAE;QACrBN,KAAK,CAACM,KAAK,GAAG,OAAO;QACrBP,OAAO,CAACO,KAAK,GAAG,KAAK;QACrB;MACF;MAEA,IAAI;QACF;QACA,MAAMC,OAAO,GAAG,MAAMV,KAAK,CAACW,GAAG,CAAC,mBAAmBP,QAAQ,EAAE,CAAC;QAC9D,MAAMQ,IAAI,GAAGF,OAAO,CAACG,IAAI,CAACA,IAAI,GAAG,CAAC,CAAC,CAAC,CAAC;;QAErC,IAAI,CAACD,IAAI,IAAI,CAACA,IAAI,CAACE,OAAO,EAAE;UAC1B,MAAM,IAAIC,KAAK,CAAC,UAAU,CAAC;QAC7B;;QAEA;QACA,MAAMC,OAAO,GAAG,MAAMjB,iBAAiB,CAACa,IAAI,CAACE,OAAO,CAAC;QACrDb,SAAS,CAACQ,KAAK,GAAGO,OAAO,CAACH,IAAI,CAACA,IAAI;MAErC,CAAC,CAAC,OAAOI,GAAG,EAAE;QACZC,OAAO,CAACf,KAAK,CAAC,SAAS,EAAEc,GAAG,CAAC;QAC7Bd,KAAK,CAACM,KAAK,GAAG,eAAe;MAC/B,CAAC,SAAS;QACRP,OAAO,CAACO,KAAK,GAAG,KAAK;MACvB;IACF,CAAC;IAEDb,SAAS,CAAC,MAAM;MACdY,kBAAkB,CAAC,CAAC;IACtB,CAAC,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}